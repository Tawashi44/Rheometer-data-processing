# Rheometer data processor

This MATLAB package is for post-processing the raw data that comes from the Thermo Fisher Haake Mars Rheometer at the Material Physics lab of TU Delft DASML.

## Getting started
1. Download the three folders (`Analysis`,`Functions`,`Measurement files`) into one folder with a folder name of your choice.
1. Add the `Functions` folder to your MATLAB path with the "Set Path" function in the "Home" tab.

## How to use
### Generating raw data .xlsx files
- This processor reads the raw data from `.xlsx` measurement files generated by the `RheoWin Data Manager` in the Rheometer computer. It is crucial that in the data manager the table template included in the `Rheometer` folder is loaded (*to be added, does not effect run of demo file*), as the processor is tailored to the outputs included in the table template, which are:
  - G' [Pa]
  - G'' [Pa]
  - |G*| [Pa]
  - eta' [Pa-s]
  - eta'' [Pa-s]
  - |eta*| [Pa-s]
  - J' [1/Pa]
  - J'' [1/Pa]
  - |J*| [1/Pa]
  - delta_p [deg]
  - tan(delta_p) [-]
  - gamma [%]
  - tau [Pa]
  - delta_s [mm]
  - T [C]
  - T_motor [C]
- The sample names are read from the sheet names. Currently, since my samples start with a `CC000` designation, the `sheet2samplename.m` looks for the index for the first 'C' and takes the following 4 characters as the sample name in the plots and output `.xlsx` file. Therefore, `CC000` must be included in the measurement files (`.rwj`) in addition to any description you want to include in the file name (e.g. `CC025_AxialForce_5_0N_rwd`).
- This processor also does RMSE analysis of all the tests in the `.xlsx` file. For this, the file name must be named in the following convention `CCXXX_{Category}.xlsx`.The category for this analysis (e.g. Different axial forces or sample thickness) is read from the file name and included in the output file. `readRheoData.m` removes the `CCXXX_` from the file name, and takes the remaining `{Category}` as the category indicated in the output file.

### Add files to the `Measurement files` folder
- Measurement files are to be placed in the `Measurement files` folder. A demo file `Demo_CCXXX_Thickness.xlsx` has been placed.

### Create and edit new analysis folder
- Copy and paste the analysis template folder to create a new analysis folder. The naming of the folder is up to the user.
- Open the main analysis file `rheoDataProcessing.m` and edit the `file_name` variable to the file name to be processed.
- Setup is complete and the code is ready to run

## Outputs
All of the outputs mentioned below are saved in the `Analysis` folder
- Plots (Plots are saved by default (`.png`, `.fig`), can be deactivated by commenting out `saveAllFigures`)
  - Dynamic shear modulus, loss tangent, and magnitude of the complex viscosity with respect to the frequency for each sample
  - Consolidated shear storage modulus for all samples
  - Consolidated shear loss modulus for all samples
  - Consolidated loss tangent for all samples
  - Consolidated magnitude of complex viscosity for all samples
- Spreadsheet
  - Mean of properties (taken up to specified cutoff frequency) for all samples
  - RMSE of these properties
    - G' [Pa]
    - G'' [Pa]
    - tan(delta_p) [-]
    - |G*| [Pa]
    - |eta*| [Pa-s]

## Test drive
- A demo measurement file has been included for a test run (`Demo_CCXXX_Thickness.xlsx`). The analysis file `rheoDataProcessing.m` is configured to read the demo file and can be run without any edits.
